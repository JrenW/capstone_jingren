<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title>Caption Search</title>
    <style>

      .result_icons {
          position: relative;
          width: 800px; ;
          height: 600px ;
          margin-top: 20px;
      }

      .video_frame {
          position: absolute;
          top: 0;
          width: 800px;
          height: 600px;
          /* background: #000; */
      }

      .caption_icon {
          position: absolute;
          top: 554px;
          width: 17px;
          height: 17px;
          border-radius: 50%;
          z-index: 1;
      }


      div.relative {
        position: relative;
        left: 180px;
        width: 800px;
        height: 900px;
        /* border: 3px solid #73AD21; */
      }

      div.absolute {
        position: absolute;
        top: 260px;
        right: 100px;

        width: 800px;
        height: 420px;
        border: 3px solid #73AD21;
        z-index: 0;
      }

  </style>

    <script src="//ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script type="text/javascript">
    // test jQuery

      $( document ).ready(function() {
        // $('img').hide();
        // $(document).on("click",'form_butt', function(){
        //     $('#search_results').load(document.URL + ' #search_results');
        // });
        // stackoverflow ref: https://stackoverflow.com/questions/18618865/load-part-page-with-jquery-ajax
        $("#form_butt").on("click", function(){
          $("#search_results").load("#search_results");
          });

        // functionality: click on an eye_icon and jump start from that mometn
        // solution:https://stackoverflow.com/questions/26257395/change-time-in-embedded-youtube-video-when-a-button-is-clicked
        $("#caption_icon").on("click", function(){
            $("#caption_icon").attr("value");
            });

       //

      });


    var time_stamp = {{time_stamp}};
    var inputURL = user_url;

    // function displayInput(){
    //   inputURL = document.getElementById('videoURL').value;
    //   // change to embed end point
    //   inputURL = inputURL.replace('https://www.youtube.com/watch?v=',
    //   'https://www.youtube.com/embed/');
    //
    //   var videoID = inputURL.split('/embed/')[1];//extract YouTube video id
    //
    //   if (inputURL.length == 0 ){
    //     document.getElementById("inputAlert").innerHTML = "you haven't pasted in anything...";
    //     document.getElementById('videoID').innerHTML = 'no video id detected...';
    //   }
    //   else
    //     document.getElementById("inputAlert").innerHTML = 'YouTube URL:  '+inputURL;
    //     document.getElementById('videoID').innerHTML = 'YouTube video ID:   '+ videoID;
    //     // insert video source to iframe
    //     document.getElementById("YouTubeVideo").src = inputURL;
    // }

    // play video from a specific time upon click of image flag_icon
    function jumpTime(i){
      i = int(i)
      // embed specific start time into video URL
      jumpedURL = {{user_url}} + '?start='+ String(time_stamp[i]);
       // reload the video
       document.getElementById("YouTubeVideo").src = jumpedURL;
     }

    </script>

  </head>




  <body>
    <!-- let's get started -->
    <div class="relative" >

      <h1>World's first YouTube video caption search engine</h1>
      <h3> >>> you can search any moment of a video by keyword here.</h3>
      <p style="color:brown;">** current link ** : {{user_url}}</p>

      <div class="result_icons">
        <!-- For loop logic of jinja template -->
          {%for i in range(0, len)%}
                <img class='caption_icon' id='eye_icon' value={{i}} onclick='jumpTime({{i}})' src="/static/icons/eye_icon.png" alt="me.jpeg"
            style=" position: absolute; left: {{icon_pos[i]}}px; ">
          {%endfor%}

          <div class="video_frame">
              <iframe id='YouTubeVideo' width="800"  height="600" src="{{user_url}}" frameborder="0" ng-show="showvideo"></iframe>
          </div>

      </div>

      <div id='keyword_form'>
        <form action="" method="POST">
            <label> Enter Keyword </label>
            <input name="keyword" id="keyword*" type="text" value="" placeholder="e.g.problem" required>
            <label> Number of Results </label>
            <input name="num_results"  id="num_results*" type="text" value="" placeholder="2" required>
            <button type=”submit” name="form_butt"> Search </button>
        </form>
      </div>

      <div id='search_results'>
        <h3>Keyword = {{keyword}}<h3>
        <h3>Num_results = {{num_results}}<h3>
        <h4>Notes: {{notes}}<h4>
        <h4>Route Number: {{route}}<h4>
        <h3>*Captions = {{captions}}<h3>
        <h3>*icon_positions = {{icon_pos}}<h3>
        <h3>*time_stamps = {{time_stamp}}<h3>

      </div>

    </div>





  </body>
</html>
